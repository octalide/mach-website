---
const exampleCode = `use std.runtime;
use std.types.string;
use console: std.io.console;

$main.symbol = "main";
fun main(args: []str) i64 {
    console.print("Hello, World!");
    ret 0;
}
`;
---

<main>
    <h1 class="logo-text">Mach</h1>
    <p class="description">programming language designed to be simple, fast, and easy to use.</p>
    <a class="cta" href="/getting-started/installation">Get Started</a>

    <div class="code-sample">
        <div class="mac-window">
            <div class="mac-controls" aria-hidden="true">
                <span class="dot red"></span>
                <span class="dot yellow"></span>
                <span class="dot green"></span>
            </div>
            <pre><code class="language-rust">{exampleCode}</code></pre>
        </div>
    </div>

    <!-- Prism.js for syntax highlighting (client-side) -->
    <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-okaidia.css"
    />
    <!-- Prism bundle (includes languages) -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
    <!-- Rust component is loaded dynamically below to avoid race conditions -->
    <!-- load the Rust language component only after Prism core is available to avoid race conditions -->
    <script>
        (function loadPrismRust() {
            if (typeof window === "undefined") return;
            const loadScript = (src: string) =>
                new Promise<void>((resolve, reject) => {
                    const s = document.createElement("script");
                    s.src = src;
                    s.onload = () => resolve();
                    s.onerror = (e) => reject(e);
                    document.head.appendChild(s);
                });

            const waitForPrism = () =>
                new Promise<void>((resolve) => {
                    if ((globalThis as any).Prism) return resolve();
                    const iv = setInterval(() => {
                        if ((globalThis as any).Prism) {
                            clearInterval(iv);
                            resolve();
                        }
                    }, 50);
                    setTimeout(() => clearInterval(iv), 5000);
                });

            (async () => {
                try {
                    await waitForPrism();
                    await loadScript(
                        "https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-rust.min.js",
                    );
                    const P = (globalThis as any).Prism;
                    const codeEl = document.querySelector(".mac-window pre code");
                    if (P && typeof P.highlightElement === "function" && codeEl)
                        P.highlightElement(codeEl);
                } catch (err) {
                    // don't block the page on highlighting errors
                    console.warn("Prism Rust load/highlight failed:", err);
                }
            })();
        })();
    </script>
    <section class="create">
        <h2 class="create-title">Create with Mach</h2>
        <div class="cards">
            <div class="card">
                <h3>Cross-platform</h3>
                <p>Build lightweight native applications across platforms.</p>
            </div>
            <div class="card">
                <h3>CLI</h3>
                <p>create fast and reliable CLI tools</p>
            </div>
            <div class="card">
                <h3>Embedded</h3>
                <p>
                    Build efficient and reliable software for resource-constrained embedded systems.
                </p>
            </div>
        </div>
    </section>
</main>

<style>
    main {
        width: 100%;
        min-height: calc(100vh - 60px);
        background-color: #1e293b;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 2rem;
        box-sizing: border-box;
    }

    .logo-text {
        font-size: 5rem;
        color: white;
        font-family: "Courier New", Courier, monospace;
        font-weight: bold;
    }
    .description {
        font-size: 1.9rem;
        color: white;
        font-family: "Courier New", Courier, monospace;
        margin-top: 1rem;
        /* typing animation*/

        white-space: nowrap;
        overflow: hidden; /* hide the overflowing characters while typing */
        border-right: 3px solid orange;
        display: inline-block;
        width: 0; /* start hidden so animation reveals text */
        animation:
            typing 3s steps(66) 1s forwards,
            blink-caret 0.75s step-end infinite;
    }

    .cta {
        margin-top: 2rem;
        padding: 0.75rem 1.5rem;
        font-size: 1.1rem;
        color: #0b1220;
        background: #f7c948;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-family: "Courier New", Courier, monospace;
        transition:
            transform 0.12s ease,
            box-shadow 0.12s ease;
    }

    .cta:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.25);
    }

    .create {
        margin-top: 2.5rem;
        width: 100%;
        max-width: 1000px;
        padding: 0 1rem;
    }

    .create-title {
        color: #cbd5e1;
        margin-bottom: 1rem;
        font-family: "Courier New", Courier, monospace;
        font-size: 2rem;
    }

    .cards {
        display: flex;
        gap: 1rem;
        justify-content: center;
        align-items: stretch;
        flex-wrap: wrap;
    }

    .code-sample {
        margin-top: 2rem;
        width: 100%;
        display: flex;
        justify-content: center;
    }
    .mac-window {
        width: min(760px, 92%);
        background: linear-gradient(180deg, #071027, #021226);
        border-radius: 12px;
        padding: 0.6rem 0.6rem 1rem 0.6rem;
        box-shadow: 0 10px 40px rgba(2, 6, 23, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.04);
        overflow: hidden;
    }
    .mac-controls {
        display: flex;
        gap: 0.5rem;
        padding: 0.5rem;
    }
    .mac-controls .dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        display: inline-block;
        box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.2);
    }
    .mac-controls .dot.red {
        background: #ff5f56;
    }
    .mac-controls .dot.yellow {
        background: #ffbd2e;
    }
    .mac-controls .dot.green {
        background: #27c93f;
    }
    .mac-window pre {
        margin: 0 auto;
        padding: 1rem;
        border-radius: 8px;
        background: transparent;
        color: #e6eef8;
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Courier New", monospace;
        font-size: 0.95rem;
        overflow: auto;
        text-align: left; /* ensure code lines are left-aligned */
        white-space: pre; /* preserve spacing exactly as in the string */
        word-break: normal;
        display: block;
    }

    .card {
        background: rgba(255, 255, 255, 0.04);
        border: 1px solid rgba(255, 255, 255, 0.04);
        padding: 1rem;
        border-radius: 8px;
        width: 220px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    .card h3 {
        font-size: 1.5rem;
        margin: 0 0 0.5rem 0;
        color: #f8fafc;
        font-family: "Courier New", Courier, monospace;
    }

    .card p {
        margin: 0;
        color: #cbd5e1;
        font-size: 1.2rem;
    }

    /* typing keyframes */
    @keyframes typing {
        from {
            width: 0;
        }
        to {
            width: 66ch;
        }
    }

    /* blinking caret */
    @keyframes blink-caret {
        from,
        to {
            border-color: transparent;
        }
        50% {
            border-color: orange;
        }
    }

    /* Responsive adjustments */
    @media (max-width: 900px) {
        .logo-text {
            font-size: clamp(2.5rem, 8vw, 4rem);
        }
        .description {
            font-size: clamp(1.05rem, 3.5vw, 1.6rem);
            width: min(66ch, 90%);
        }
        .cta {
            font-size: clamp(1rem, 3.5vw, 1.05rem);
            padding: 0.6rem 1.2rem;
        }
        .card {
            width: 200px;
        }
    }

    /* Small screens: stack cards, allow description to wrap and disable typing animation for readability */
    @media (max-width: 680px) {
        main {
            padding-top: 3rem;
            justify-content: flex-start;
        }
        .description {
            white-space: normal;
            display: block;
            border-right: 0;
            width: 100%;
            animation: none;
            text-wrap: balance;
        }
        .cards {
            flex-direction: column;
            gap: 0.75rem;
            align-items: center;
        }
        .card {
            width: 100%;
            max-width: 420px;
        }
        .create-title {
            font-size: 1.5rem;
        }
    }

    /* Very small phones */
    @media (max-width: 420px) {
        .logo-text {
            font-size: 2.5rem;
        }
        .description {
            font-size: 1rem;
            margin-top: 0.75rem;
        }
        .card p {
            font-size: 1rem;
        }
        .cards {
            padding: 0 0.5rem;
        }
    }

    /* Respect user preference for reduced motion */
    @media (prefers-reduced-motion: reduce) {
        .description {
            animation: none !important;
            border-right: 0 !important;
            width: auto !important;
            overflow: visible !important;
        }
    }
</style>
